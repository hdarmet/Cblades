<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cursed Blades</title>
</head>
<body>
<p>That is Cursed Blades</p>

<script type="module">

    import {
        CBGame, CBMap, CBHexId, CBHexSideId
    } from "../jslib/cblades/game.js";
    import {
        CBTroop, CBWing, CBCharacter, CBFormation, CBUnitType
    } from "../jslib/cblades/unit.js";
    import {
        CBInteractivePlayer
    } from "../jslib/cblades/interactive-player.js";
    import {
        CBArbitrator
    } from "../jslib/cblades/arbitrator.js";
    import {
        registerInteractiveMovement
    } from "../jslib/cblades/interactive-movement.js";
    import {
        registerInteractiveCombat
    } from "../jslib/cblades/interactive-combat.js";
    import {
        registerInteractiveRecover
    } from "../jslib/cblades/interactive-recover.js";
    import {
        registerInteractiveCommand
    } from "../jslib/cblades/interactive-command.js";
    import {
        registerInteractiveFormation
    } from "../jslib/cblades/interactive-formation.js";
    import {
        registerInteractiveMiscellaneous
    } from "../jslib/cblades/interactive-miscellaneous.js";
    import {
        registerInteractiveMagic
    } from "../jslib/cblades/interactive-magic.js";

    registerInteractiveMovement();
    registerInteractiveCombat();
    registerInteractiveRecover();
    registerInteractiveCommand();
    registerInteractiveFormation();
    registerInteractiveMagic();
    registerInteractiveMiscellaneous();

    let game = new CBGame();
    document.body.appendChild(game.root);
    let arbitrator = new CBArbitrator();
    game.setArbitrator(arbitrator);
    let map = new CBMap("/CBlades/images/maps/map1.png");
    game.setMap(map);
    game.setMenu();

    let goblinLeader = new CBUnitType("Goblin Leader",
        [
            "/CBlades/images/units/orcs/character1L.png",
            "/CBlades/images/units/orcs/character1Lb.png"
        ]
    );
    let goblinWolfRider = new CBUnitType("Goblin Wolf Rider",
        [
            "/CBlades/images/units/orcs/unit1L.png",
            "/CBlades/images/units/orcs/unit1Lb.png"
        ]
    );

    let companyLeader = new CBUnitType("Company Leader",
        [
            "/CBlades/images/units/mercenaries/character1L.png",
            "/CBlades/images/units/mercenaries/character1Lb.png"
        ]
    );
    let companyKnight = new CBUnitType("Company Knight",
        [
            "/CBlades/images/units/mercenaries/unit1L.png",
            "/CBlades/images/units/mercenaries/unit1Lb.png"
        ]
    );
    let companyLance = new CBUnitType("Company Lancet",
        [
            "/CBlades/images/units/mercenaries/unit2L1.png",
            "/CBlades/images/units/mercenaries/unit2L1b.png"
        ],
        [
            "/CBlades/images/units/mercenaries/unit2L4.png",
            "/CBlades/images/units/mercenaries/unit2L4b.png",
            "/CBlades/images/units/mercenaries/unit2L3.png",
            "/CBlades/images/units/mercenaries/unit2L3b.png",
            "/CBlades/images/units/mercenaries/unit2L2.png",
            "/CBlades/images/units/mercenaries/unit2L2b.png"
        ]
    );

    let player1 = new CBInteractivePlayer();
    game.addPlayer(player1);
    let wing1 = new CBWing(player1);
    let character11 = new CBCharacter(goblinLeader, wing1);
    wing1.setLeader(character11);
    let counter11 = new CBTroop(goblinWolfRider, wing1);
    counter11.lossSteps = 1;
    let counter12 = new CBTroop(goblinWolfRider, wing1);
    counter12.lossSteps = 1;
    game.addUnit(character11, new CBHexId(map, 4, 11));
    game.addUnit(counter11, new CBHexId(map, 3, 10));
    game.addUnit(counter12, new CBHexId(map, 6, 10));

    let player2 = new CBInteractivePlayer();
    game.addPlayer(player2);
    let wing2 = new CBWing(player2);
    let character21 = new CBCharacter(companyLeader, wing2);
    wing2.setLeader(character21);
    character21.angle = 180;
    let counter21 = new CBTroop(companyKnight, wing2);
    counter21.angle = 180;
    let counter22 = new CBTroop(companyKnight, wing2);
    counter22.angle = 180;
    let counter23 = new CBFormation(companyLance, wing2, 2);
    counter23.angle = 210;
    counter23.lossSteps = 4;
    let counter24 = new CBFormation(companyLance, wing2, 2);
    counter24.angle = 210;
    counter24.lossSteps = 2;
    game.addUnit(counter23, new CBHexSideId( map.getHex(9, 6),  map.getHex(10, 6)));
    game.addUnit(counter24, new CBHexSideId( map.getHex(9, 5),  map.getHex(10, 5)));
    game.addUnit(character21, new CBHexId(map, 8, 6));
    game.addUnit(counter21, new CBHexId(map, 7, 7));
    game.addUnit(counter22, new CBHexId(map, 10, 7));
    game.start();
</script>
</body>
</html>