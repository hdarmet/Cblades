<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cursed Blades</title>
</head>
<body>

<script type="module">

    import {
        CBScenarioEditorGame, CBEditorPlayer
    } from "../jslib/cblades/editor.js";
    import {
        CBMap
    } from "../jslib/cblades/map.js";
    import {
        CBWing
    } from "../jslib/cblades/unit.js";
    import {
        GoblinBanner1
    } from "../jslib/cblades/armies/orcs.js";
    import {
        RoughneckBanner1
    } from "../jslib/cblades/armies/roughnecks.js";
    import {
        registerResponse
    } from "./patch.js";
    import {
        GameLoader
    } from "../jslib/cblades/loader.js";

    let game = new CBScenarioEditorGame("scenario");

    registerResponse("/api/player-identity/all", [
        {path:"./../images/units/players/orc-1.png", name:"orc-1"},
        {path:"./../images/units/players/orc-2.png", name:"player1"},
        {path:"./../images/units/players/roughneck-1.png", name:"roughneck-1"},
        {path:"./../images/units/players/roughneck-2.png", name:"player3"},
        {path:"./../images/units/players/orc-1.png", name:"player4"},
        {path:"./../images/units/players/orc-2.png", name:"player5"},
        {path:"./../images/units/players/roughneck-1.png", name:"player6"},
        {path:"./../images/units/players/roughneck-2.png", name:"player7"},
        {path:"./../images/units/players/orc-1.png", name:"player8"},
        {path:"./../images/units/players/orc-2.png", name:"player9"},
        {path:"./../images/units/players/roughneck-1.png", name:"player10"},
        {path:"./../images/units/players/roughneck-2.png", name:"player11"},
        {path:"./../images/units/players/orc-1.png", name:"player12"},
        {path:"./../images/units/players/orc-2.png", name:"player13"},
        {path:"./../images/units/players/roughneck-1.png", name:"player14"},
        {path:"./../images/units/players/roughneck-2.png", name:"player15"},
        {path:"./../images/units/players/orc-1.png", name:"player16"},
        {path:"./../images/units/players/orc-2.png", name:"player17"},
        {path:"./../images/units/players/roughneck-1.png", name:"player18"},
        {path:"./../images/units/players/roughneck-2.png", name:"player19"},
        {path:"./../images/units/players/orc-1.png", name:"player20"},
        {path:"./../images/units/players/orc-2.png", name:"player21"},
        {path:"./../images/units/players/roughneck-1.png", name:"player22"},
        {path:"./../images/units/players/roughneck-2.png", name:"player23"},
        {path:"./../images/units/players/orc-1.png", name:"player24"},
        {path:"./../images/units/players/orc-2.png", name:"player25"},
        {path:"./../images/units/players/roughneck-1.png", name:"player26"},
        {path:"./../images/units/players/roughneck-2.png", name:"player27"},
        {path:"./../images/units/players/orc-1.png", name:"player28"},
        {path:"./../images/units/players/orc-2.png", name:"player29"},
        {path:"./../images/units/players/roughneck-1.png", name:"player30"},
        {path:"./../images/units/players/roughneck-2.png", name:"player31"},
        {path:"./../images/units/players/orc-1.png", name:"player32"},
        {path:"./../images/units/players/orc-2.png", name:"player33"},
        {path:"./../images/units/players/roughneck-1.png", name:"player34"},
        {path:"./../images/units/players/roughneck-2.png", name:"player35"},
        {path:"./../images/units/players/orc-1.png", name:"player36"},
        {path:"./../images/units/players/orc-2.png", name:"player37"},
        {path:"./../images/units/players/roughneck-1.png", name:"player38"},
        {path:"./../images/units/players/roughneck-2.png", name:"player39"},
        {path:"./../images/units/players/roughneck-1.png", name:"player40"},
        {path:"./../images/units/players/roughneck-2.png", name:"player41"}
    ]);

    registerResponse("/api/banner/all", [
        {path:"./../images/units/orcs/banners/banner0.png", name:"orc-banner-1"},
        {path:"./../images/units/orcs/banners/banner1.png", name:"orc-banner-2"},
        {path:"./../images/units/orcs/banners/banner2.png", name:"banner2"},
        {path:"./../images/units/mercenaries/banners/banner0.png", name:"roughneck-banner-1"},
        {path:"./../images/units/mercenaries/banners/banner1.png", name:"roughneck-banner-2"},
        {path:"./../images/units/mercenaries/banners/banner2.png", name:"banner5"},
        {path:"./../images/units/orcs/banners/banner0.png", name:"banner6"},
        {path:"./../images/units/orcs/banners/banner1.png", name:"banner7"},
        {path:"./../images/units/orcs/banners/banner2.png", name:"banner8"},
        {path:"./../images/units/mercenaries/banners/banner0.png", name:"banner9"},
        {path:"./../images/units/mercenaries/banners/banner1.png", name:"banner10"},
        {path:"./../images/units/mercenaries/banners/banner2.png", name:"banner11"},
        {path:"./../images/units/orcs/banners/banner0.png", name:"banner12"},
        {path:"./../images/units/orcs/banners/banner1.png", name:"banner13"},
        {path:"./../images/units/orcs/banners/banner2.png", name:"banner14"},
        {path:"./../images/units/mercenaries/banners/banner0.png", name:"banner15"},
        {path:"./../images/units/mercenaries/banners/banner1.png", name:"banner16"},
        {path:"./../images/units/mercenaries/banners/banner2.png", name:"banner17"},
        {path:"./../images/units/orcs/banners/banner0.png", name:"banner18"},
        {path:"./../images/units/orcs/banners/banner1.png", name:"banner19"},
        {path:"./../images/units/orcs/banners/banner2.png", name:"banner20"},
        {path:"./../images/units/mercenaries/banners/banner0.png", name:"banner21"},
        {path:"./../images/units/mercenaries/banners/banner1.png", name:"banner22"},
        {path:"./../images/units/mercenaries/banners/banner2.png", name:"banner23"},
        {path:"./../images/units/orcs/banners/banner0.png", name:"banner24"},
        {path:"./../images/units/orcs/banners/banner1.png", name:"banner25"},
        {path:"./../images/units/orcs/banners/banner2.png", name:"banner26"},
        {path:"./../images/units/mercenaries/banners/banner0.png", name:"banner27"},
        {path:"./../images/units/mercenaries/banners/banner1.png", name:"banner28"},
        {path:"./../images/units/mercenaries/banners/banner2.png", name:"banner29"}
    ]);

    registerResponse("/api/board/all", [
        {path: "./../images/maps/map-1.png", icon: "./../images/maps/map-1-icon.png"},
        {path: "./../images/maps/map-2.png", icon: "./../images/maps/map-2-icon.png"},
        {path: "./../images/maps/map-3.png", icon: "./../images/maps/map-3-icon.png"},
        {path: "./../images/maps/map-4.png", icon: "./../images/maps/map-4-icon.png"},
        {path: "./../images/maps/map-5.png", icon: "./../images/maps/map-5-icon.png"},
        {path: "./../images/maps/map-6.png", icon: "./../images/maps/map-6-icon.png"},
        {path: "./../images/maps/map-7.png", icon: "./../images/maps/map-7-icon.png"},
        {path: "./../images/maps/map-8.png", icon: "./../images/maps/map-8-icon.png"},
        {path: "./../images/maps/map-9.png", icon: "./../images/maps/map-9-icon.png"},
        {path: "./../images/maps/map-10.png", icon: "./../images/maps/map-10-icon.png"},
        {path: "./../images/maps/map-11.png", icon: "./../images/maps/map-11-icon.png"},
        {path: "./../images/maps/map-12.png", icon: "./../images/maps/map-12-icon.png"},
        {path: "./../images/maps/map-13.png", icon: "./../images/maps/map-13-icon.png"},
        {path: "./../images/maps/map-14.png", icon: "./../images/maps/map-14-icon.png"},
        {path: "./../images/maps/map-15.png", icon: "./../images/maps/map-15-icon.png"},
        {path: "./../images/maps/map-16.png", icon: "./../images/maps/map-16-icon.png"},
        {path: "./../images/maps/map-17.png", icon: "./../images/maps/map-17-icon.png"},
        {path: "./../images/maps/map-18.png", icon: "./../images/maps/map-18-icon.png"},
        {path: "./../images/maps/map-19.png", icon: "./../images/maps/map-19-icon.png"},
        {path: "./../images/maps/map-20.png", icon: "./../images/maps/map-20-icon.png"},
        {path: "./../images/maps/map-21.png", icon: "./../images/maps/map-21-icon.png"}
    ]);

    registerResponse("/api/game/create",
        requestContent=>JSON.stringify(requestContent)
    );
    registerResponse("/api/game/update/",
        requestContent=>JSON.stringify(requestContent)
    );
    registerResponse("/api/game/by-name/scenario",
        requestContent=>JSON.stringify(new GameLoader(game, requestContent).toSpecs())
    );

    let map = new CBMap([
        {path:"./../images/maps/map-1.png", icon:"./../images/maps/map-1-icon.png", col:0, row:0, invert:true},
        {path:"./../images/maps/map-4.png", icon:"./../images/maps/map-4-icon.png", col:1, row:0}
    ]);
    game.setMap(map);
    game.fitWindow();
    document.body.appendChild(game.root);
    game.setMenu();

    let player1 = new CBEditorPlayer("orc-1", "./../images/units/players/orc-1.png");
    game.addPlayer(player1);
    let wing1 = new CBWing(player1, GoblinBanner1);
    wing1.setRetreatZone(map.getSouthZone());
    let player2 = new CBEditorPlayer("roughneck-1", "./../images/units/players/roughneck-1.png");
    game.addPlayer(player2);
    let wing2 = new CBWing(player2, RoughneckBanner1);
    wing2.setRetreatZone(map.getNorthZone());
    game.start();

</script>
</body>
</html>